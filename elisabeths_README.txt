NOTE:

Sometimes the "and" instruction begining on line 942 causes the CPU profiler
to segfault. I have not been able to predict nor understand this behavior. If 
profiler is segfaulting, simply comment out the existing code and uncomment the original.